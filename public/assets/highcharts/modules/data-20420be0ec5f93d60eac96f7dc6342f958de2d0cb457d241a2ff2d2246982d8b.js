!function(e){var t,r=e.each,s=e.pick,n=HighchartsAdapter.inArray,i=e.splat,o=function(e,t){this.init(e,t)};e.extend(o.prototype,{init:function(e,t){this.options=e,this.chartOptions=t,this.columns=e.columns||this.rowsToColumns(e.rows)||[],this.firstRowAsNames=s(e.firstRowAsNames,!0),this.decimalRegex=e.decimalPoint&&new RegExp("^([0-9]+)"+e.decimalPoint+"([0-9]+)$"),this.rawColumns=[],this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var s,n=this.chartOptions,i=this.options,o=[],a=function(t){return(e.seriesTypes[t||"line"].prototype.pointArrayMap||[0]).length},l=function(t){return e.seriesTypes[t||"line"].prototype.pointArrayMap},u=n&&n.chart&&n.chart.type,h=[],m=[],d=0;r(n&&n.series||[],function(e){h.push(a(e.type||u))}),r(i&&i.seriesMapping||[],function(e){o.push(e.x||0)}),0===o.length&&o.push(0),r(i&&i.seriesMapping||[],function(e){var r,i=new t,o=h[d]||a(u),p=n&&n.series||[],c=p[d]||{},f=l(c.type||u)||["y"];i.addColumnReader(e.x,"x");for(r in e)e.hasOwnProperty(r)&&"x"!==r&&i.addColumnReader(e[r],r);for(s=0;o>s;s++)i.hasReader(f[s])||i.addColumnReader(void 0,f[s]);m.push(i),d++});var p=l(u);void 0===p&&(p=["y"]),this.valueCount={global:a(u),xColumns:o,individual:h,seriesBuilders:m,globalPointArrayMap:p}},dataFound:function(){this.options.switchRowsAndColumns&&(this.columns=this.rowsToColumns(this.columns)),this.getColumnDistribution(),this.parseTypes(),this.parsed()!==!1&&this.complete()},parseCSV:function(){var e,t,s=this,n=this.options,i=n.csv,o=this.columns,a=n.startRow||0,l=n.endRow||Number.MAX_VALUE,u=n.startColumn||0,h=n.endColumn||Number.MAX_VALUE,m=0;i&&(t=i.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(n.lineDelimiter||"\n"),e=n.itemDelimiter||(-1!==i.indexOf("	")?"	":","),r(t,function(t,n){var i,d=s.trim(t),p=0===d.indexOf("#"),c=""===d;n>=a&&l>=n&&!p&&!c&&(i=t.split(e),r(i,function(e,t){t>=u&&h>=t&&(o[t-u]||(o[t-u]=[]),o[t-u][m]=e)}),m+=1)}),this.dataFound())},parseTable:function(){var e=this.options,t=e.table,s=this.columns,n=e.startRow||0,i=e.endRow||Number.MAX_VALUE,o=e.startColumn||0,a=e.endColumn||Number.MAX_VALUE;t&&("string"==typeof t&&(t=document.getElementById(t)),r(t.getElementsByTagName("tr"),function(e,t){t>=n&&i>=t&&r(e.children,function(e,r){("TD"===e.tagName||"TH"===e.tagName)&&r>=o&&a>=r&&(s[r-o]||(s[r-o]=[]),s[r-o][t-n]=e.innerHTML)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var e,t,r=this,s=this.options,n=s.googleSpreadsheetKey,i=this.columns,o=s.startRow||0,a=s.endRow||Number.MAX_VALUE,l=s.startColumn||0,u=s.endColumn||Number.MAX_VALUE;n&&jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+n+"/"+(s.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",error:s.error,success:function(s){var n,h,m=s.feed.entry,d=m.length,p=0,c=0;for(h=0;d>h;h++)n=m[h],p=Math.max(p,n.gs$cell.col),c=Math.max(c,n.gs$cell.row);for(h=0;p>h;h++)h>=l&&u>=h&&(i[h-l]=[],i[h-l].length=Math.min(c,a-o));for(h=0;d>h;h++)n=m[h],e=n.gs$cell.row-1,t=n.gs$cell.col-1,t>=l&&u>=t&&e>=o&&a>=e&&(i[t-l][e-o]=n.content.$t);r.dataFound()}})},trim:function(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[0-9\s]+$/.test(e)&&(e=e.replace(/\s/g,"")),this.decimalRegex&&(e=e.replace(this.decimalRegex,"$1.$2"))),e},parseTypes:function(){for(var e=this.columns,t=e.length;t--;)this.parseColumn(e[t],t)},parseColumn:function(e,t){var r,s,o,a,l,u,h,m=this.rawColumns,d=this.columns,p=e.length,c=this.firstRowAsNames,f=-1!==n(t,this.valueCount.xColumns),g=[],v=this.chartOptions,x=this.options.columnTypes||[],y=x[t],C=f&&(v&&v.xAxis&&"category"===i(v.xAxis)[0].type||"string"===y);for(m[t]||(m[t]=[]);p--;)r=g[p]||e[p],o=this.trim(r),a=this.trim(r,!0),s=parseFloat(a),void 0===m[t][p]&&(m[t][p]=o),C||0===p&&c?e[p]=o:+a===s?(e[p]=s,s>31536e6&&"float"!==y?e.isDatetime=!0:e.isNumeric=!0,void 0!==e[p+1]&&(h=s>e[p+1])):(l=this.parseDate(r),f&&"number"==typeof l&&!isNaN(l)&&"float"!==y?(g[p]=r,e[p]=l,e.isDatetime=!0,void 0!==e[p+1]&&(u=l>e[p+1],u!==h&&void 0!==h&&(this.alternativeFormat?(this.dateFormat=this.alternativeFormat,p=e.length,this.alternativeFormat=this.dateFormats[this.dateFormat].alternative):e.unsorted=!0),h=u)):(e[p]=""===o?null:o,0!==p&&(e.isDatetime||e.isNumeric)&&(e.mixed=!0)));if(f&&e.mixed&&(d[t]=m[t]),f&&h&&this.options.sort)for(t=0;t<d.length;t++)d[t].reverse(),c&&d[t].unshift(d[t].pop())},dateFormats:{"YYYY-mm-dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[1],e[2]-1,+e[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(e){return Date.UTC(+e[3],e[2]-1,+e[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(e){return Date.UTC(+e[3],e[1]-1,+e[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[3]+2e3,e[2]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[3]+2e3,e[1]-1,+e[2])}}},parseDate:function(e){var t,r,s,n,i=this.options.parseDate,o=this.options.dateFormat||this.dateFormat;if(i)t=i(e);else if("string"==typeof e){if(o)s=this.dateFormats[o],n=e.match(s.regex),n&&(t=s.parser(n));else for(r in this.dateFormats)if(s=this.dateFormats[r],n=e.match(s.regex)){this.dateFormat=o=r,this.alternativeFormat=s.alternative,t=s.parser(n);break}n||(n=Date.parse(e),"object"==typeof n&&null!==n&&n.getTime?t=n.getTime()-6e4*n.getTimezoneOffset():"number"!=typeof n||isNaN(n)||(t=n-6e4*new Date(n).getTimezoneOffset()))}return t},rowsToColumns:function(e){var t,r,s,n,i;if(e)for(i=[],r=e.length,t=0;r>t;t++)for(n=e[t].length,s=0;n>s;s++)i[s]||(i[s]=[]),i[s][t]=e[t][s];return i},parsed:function(){return this.options.parsed?this.options.parsed.call(this,this.columns):void 0},getFreeIndexes:function(e,t){var r,s,n,i=[],o=[];for(s=0;e>s;s+=1)i.push(!0);for(r=0;r<t.length;r+=1)for(n=t[r].getReferencedColumnIndexes(),s=0;s<n.length;s+=1)i[n[s]]=!1;for(s=0;s<i.length;s+=1)i[s]&&o.push(s);return o},complete:function(){var e,r,s,i,o,a,l,u,h,m,d,p,c=this.columns,f=[],g=this.options,v=[];if(f.length=c.length,g.complete||g.afterComplete){for(i=0;i<c.length;i++)this.firstRowAsNames&&(c[i].name=c[i].shift());for(r=[],m=this.getFreeIndexes(c.length,this.valueCount.seriesBuilders),l=0;l<this.valueCount.seriesBuilders.length;l++)h=this.valueCount.seriesBuilders[l],h.populateColumns(m)&&v.push(h);for(;m.length>0;){for(h=new t,h.addColumnReader(0,"x"),p=n(0,m),-1!==p&&m.splice(p,1),i=0;i<this.valueCount.global;i++)h.addColumnReader(void 0,this.valueCount.globalPointArrayMap[i]);h.populateColumns(m)&&v.push(h)}if(v.length>0&&v[0].readers.length>0&&(d=c[v[0].readers[0].columnIndex],void 0!==d&&(d.isDatetime?e="datetime":d.isNumeric||(e="category"))),"category"===e)for(l=0;l<v.length;l++)for(h=v[l],a=0;a<h.readers.length;a++)"x"===h.readers[a].configName&&(h.readers[a].configName="name");for(l=0;l<v.length;l++){for(h=v[l],s=[],o=0;o<c[0].length;o++)s[o]=h.read(c,o);r[l]={data:s},h.name&&(r[l].name=h.name),"category"===e&&(r[l].turboThreshold=0)}u={series:r},e&&(u.xAxis={type:e}),g.complete&&g.complete(u),g.afterComplete&&g.afterComplete(u)}}}),e.Data=o,e.data=function(e,t){return new o(e,t)},e.wrap(e.Chart.prototype,"init",function(t,r,s){var n=this;r&&r.data?e.data(e.extend(r.data,{afterComplete:function(i){var o,a;if(r.hasOwnProperty("series"))if("object"==typeof r.series)for(o=Math.max(r.series.length,i.series.length);o--;)a=r.series[o]||{},r.series[o]=e.merge(a,i.series[o]);else delete r.series;r=e.merge(i,r),t.call(n,r,s)}}),r):t.call(n,r,s)}),t=function(){this.readers=[],this.pointIsArray=!0},t.prototype.populateColumns=function(e){var t=this,s=!0;return r(t.readers,function(t){void 0===t.columnIndex&&(t.columnIndex=e.shift())}),r(t.readers,function(e){void 0===e.columnIndex&&(s=!1)}),s},t.prototype.read=function(e,t){var s,n=this,i=n.pointIsArray,o=i?[]:{};return r(n.readers,function(r){var s=e[r.columnIndex][t];i?o.push(s):o[r.configName]=s}),void 0===this.name&&n.readers.length>=2&&(s=n.getReferencedColumnIndexes(),s.length>=2&&(s.shift(),s.sort(),this.name=e[s.shift()].name)),o},t.prototype.addColumnReader=function(e,t){this.readers.push({columnIndex:e,configName:t}),"x"!==t&&"y"!==t&&void 0!==t&&(this.pointIsArray=!1)},t.prototype.getReferencedColumnIndexes=function(){var e,t,r=[];for(e=0;e<this.readers.length;e+=1)t=this.readers[e],void 0!==t.columnIndex&&r.push(t.columnIndex);return r},t.prototype.hasReader=function(e){var t,r;for(t=0;t<this.readers.length;t+=1)if(r=this.readers[t],r.configName===e)return!0}}(Highcharts);