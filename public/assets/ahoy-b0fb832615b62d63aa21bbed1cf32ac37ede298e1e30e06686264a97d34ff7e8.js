!function(t){"use strict";function e(t,e,n){var i="",r="";if(n){var o=new Date;o.setTime(o.getTime()+60*n*1e3),i="; expires="+o.toGMTString()}x.domain&&(r="; domain="+x.domain),document.cookie=t+"="+escape(e)+i+r+"; path=/"}function n(t){var e,n,i=t+"=",r=document.cookie.split(";");for(e=0;e<r.length;e++){for(n=r[e];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(i))return unescape(n.substring(i.length,n.length))}return null}function i(t){e(t,"",-1)}function r(e){n("ahoy_debug")&&t.console.log(e)}function o(){for(var t;t=m.shift();)t();k=!0}function a(t){k?t():m.push(t)}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})}function s(){_&&e("ahoy_events",JSON.stringify(b),1)}function u(t){a(function(){_&&v.ajax({type:"POST",url:w,data:JSON.stringify([t]),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){for(var e=0;e<b.length;e++)if(b[e].id==t.id){b.splice(e,1);break}s()}})})}function f(){return x.page||t.location.pathname}function h(t){var e=v(t.currentTarget);return{tag:e.get(0).tagName.toLowerCase(),id:e.attr("id"),"class":e.attr("class"),page:f(),section:e.closest("*[data-section]").data("section")}}var g,l,d,x=t.ahoy||t.Ahoy||{},v=t.jQuery||t.Zepto||t.$,y=240,p=1051200,k=!1,m=[],_="undefined"!=typeof JSON&&"undefined"!=typeof JSON.stringify,b=[],T=x.visitsUrl||"/ahoy/visits",w=x.eventsUrl||"/ahoy/events";if(g=n("ahoy_visit"),l=n("ahoy_visitor"),d=n("ahoy_track"),g&&l&&!d)r("Active visit"),o();else if(d&&i("ahoy_track"),g||(g=c(),e("ahoy_visit",g,y)),n("ahoy_visit")){r("Visit started"),l||(l=c(),e("ahoy_visitor",l,p));var S={visit_token:g,visitor_token:l,platform:x.platform||"Web",landing_page:t.location.href,screen_width:t.screen.width,screen_height:t.screen.height};document.referrer.length>0&&(S.referrer=document.referrer),r(S),v.post(T,S,o,"json")}else r("Cookies disabled"),o();x.getVisitId=x.getVisitToken=function(){return g},x.getVisitorId=x.getVisitorToken=function(){return l},x.reset=function(){return i("ahoy_visit"),i("ahoy_visitor"),i("ahoy_events"),i("ahoy_track"),!0},x.debug=function(t){return t===!1?i("ahoy_debug"):e("ahoy_debug","t",525600),!0},x.track=function(t,e){var n={id:c(),name:t,properties:e,time:(new Date).getTime()/1e3};r(n),b.push(n),s(),setTimeout(function(){u(n)},1e3)},x.trackView=function(){var e={url:t.location.href,title:document.title,page:f()};x.track("$view",e)},x.trackClicks=function(){v(document).on("click","a, button, input[type=submit]",function(t){var e=v(t.currentTarget),n=h(t);n.text="input"==n.tag?e.val():v.trim(e.text().replace(/[\s\r\n]+/g," ")),n.href=e.attr("href"),x.track("$click",n)})},x.trackSubmits=function(){v(document).on("submit","form",function(t){var e=h(t);x.track("$submit",e)})},x.trackChanges=function(){v(document).on("change","input, textarea, select",function(t){var e=h(t);x.track("$change",e)})},x.trackAll=function(){x.trackView(),x.trackClicks(),x.trackSubmits(),x.trackChanges()};try{b=JSON.parse(n("ahoy_events")||"[]")}catch(O){}for(var V=0;V<b.length;V++)u(b[V]);t.ahoy=x}(window);